const sheetID = "1lwe6yHI2mn4nyu9ln_cWyXo1NKuu-NtAP7TMaYGsp3U"; const sheetName = "Sheet1"; function calculateReturn(stockName) { fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${sheetName}!A1:E8?key=AIzaSyD6AKVhVErZ4aZcAIdT_G82ViFj2TWlx0k`) .then(response => response.json()) .then(data => { const values = data.values; const headers = values[0]; const stockIndex = headers.indexOf(stockName); if (stockIndex < 0) { document.getElementById("result").innerHTML = "Invalid stock selected."; return; } const currentPrice = parseFloat(values[1][stockIndex]); const initialOutlay = parseFloat(values[2][stockIndex]); const returnPercentage = ((currentPrice / initialOutlay) - 1) * 100; document.getElementById("result").innerHTML = `${stockName}: ${returnPercentage.toFixed(2)}%`; }) .catch(error => { console.error(error); document.getElementById("result").innerHTML = "An error occurred."; }); } const form = document.querySelector("form"); form.addEventListener("submit", event => { event.preventDefault(); const stockName = document.getElementById("stock").value.toUpperCase(); calculateReturn(stockName); });
